```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVENT INVITATION & RSVP</title>
    <link rel="stylesheet" href="index.css">
    <style>
        /* Additional styles to enhance contact section visibility and layout */
        .contact-section {
            padding: 2rem;
            max-width: 100%;
            margin: 0 auto;
            text-align: left;
            display: block !important;
        }
        .contact-section form {
            max-width: 600px;
            margin: 1em auto 0 auto;
            display: flex;
            flex-direction: column;
            gap: 0.7em;
        }
        .contact-section p {
            text-align: left;
            max-width: 600px;
            margin: 0 auto 1em auto;
        }
        /* Center the navigation links */
        .navbar {
            justify-content: center;
            position: relative;
        }
        .navbar-brand {
            position: absolute;
            left: 2rem;
            margin: 0;
        }
        .navbar-links {
            margin: 0;
            justify-content: center;
        }
        @media (max-width: 768px) {
            .contact-section {
                padding: 1rem;
            }
            .contact-section form {
                max-width: 100%;
            }
            .navbar-brand {
                position: static;
                left: auto;
            }
            .navbar {
                flex-direction: column;
                gap: 1rem;
            }
            .navbar-links {
                margin: 0;
            }
        }
        /* Login Modal Styles */
        .login-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .login-modal-overlay.active {
            display: flex;
        }
        .login-section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            max-width: 400px;
            width: 90%;
            position: relative;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .login-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        .login-section form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .login-section label {
            font-weight: bold;
        }
        .login-section input {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .login-section button {
            background: #007bff;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 4px;
            cursor: pointer;
        }
        .login-section button:hover {
            background: #0056b3;
        }
        .login-message {
            margin-top: 1rem;
            padding: 0.5rem;
            border-radius: 4px;
            display: none;
        }
        .login-message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .login-message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .login-link {
            text-align: center;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        .login-link a {
            color: #007bff;
            text-decoration: none;
        }
        .google-signin {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            background: #4285f4;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
        }
        .google-signin:hover {
            background: #3367d6;
        }
        .google-signin img {
            width: 18px;
            height: 18px;
        }
        .github-signin {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            background: #24292e;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            text-decoration: none;
        }
        .github-signin:hover {
            background: #1a1f23;
        }
        .github-signin img {
            width: 18px;
            height: 18px;
        }
        .microsoft-signin {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            background: #0078d4;
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            text-decoration: none;
        }
        .microsoft-signin:hover {
            background: #106ebe;
        }
        .microsoft-signin img {
            width: 18px;
            height: 18px;
        }
        .divider {
            text-align: center;
            margin: 1rem 0;
            position: relative;
        }
        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #ddd;
        }
        .divider span {
            background: white;
            padding: 0 1rem;
            color: #666;
        }
        .social-logins {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
    </style>
</head>
<body>
  <div class="universe" aria-hidden="true">
    <div class="stars"></div>
    <div class="sun"></div>
    <div class="orbit"><div class="earth"></div></div>
  </div>
  <nav class="navbar">
    <div class="navbar-brand">Event RSVP</div>
    <ul class="navbar-links">
      <li><a href="#events" class="nav-link nav-home active">Home</a></li>
      <li><a href="#about" class="nav-link nav-about">About</a></li>
      <li><a href="#contact" class="nav-link nav-contact">Contact</a></li>
      <li><a href="#login" class="nav-link nav-login">Login</a></li>
    </ul>
  
  </nav>
  <main class="main-content">
    <section class="event-cards" id="events">
      <div class="event-card" data-event="culture">
        <img src="https://images.unsplash.com/photo-1511285560929-80b456fea0bc?ixlib=rb-4.0.3&w=100&h=100&fit=crop&q=80" alt="Vibrant cultural festival celebration" width="100px" height="100px" style="border-radius: 100%;">
        <h2>Culture Gala 2026</h2>
        <p><strong>Date:</strong> October 8, 2026<br>
        <strong>Time:</strong> 7:00 PM - 11:00 PM<br>
        <strong>Location:</strong> Graduation Square<br>
        <strong>Capacity:</strong> 500 guests<br>
        <strong>Ticket Price:</strong> $25 (General Admission)</p>
        <p>Celebrate world cultures with music, dance, and vibrant performances from around the globe. Highlights include live folk dances from Asia, Latin American rhythms, African drumming sessions, and international cuisine tasting.</p>
        <div class="event-video">
          <h3>Event Recap Video</h3>
          <iframe width="100%" height="200" src="https://www.youtube.com/embed/cPk1o_4TkGE" title="2025 World Cultural Dance Festival Promotional Video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <ul class="event-highlights">
          <li>üé≠ Featured Performers: International Dance Ensemble & Global Music Collective</li>
          <li>‚úÇ Interactive Workshops: Cultural Craft Making & Language Taster Sessions</li>
          <li>ü§ù Networking Mixer: Connect with cultural enthusiasts and experts</li>
        </ul>
        <button class="book-btn">Book</button>
      </div>
      <div class="event-card" data-event="worship">
        <img src="worship event.jpeg" alt="Crowd at worship concert with hands raised" width="100px" height="100px" style="border-radius: 100%;">
        <h2>Worship Event 2026</h2>
        <p><strong>Date:</strong> November 15, 2026<br>
        <strong>Time:</strong> 6:00 PM - 9:00 PM<br>
        <strong>Location:</strong> Old Auditorium, 12 Heritage Road<br>
        <strong>Capacity:</strong> 300 seats<br>
        <strong>Ticket Price:</strong> Free (Donations Welcome)</p>
        <p>Join us for a soulful evening of music, reflection, and community worship. Experience uplifting contemporary worship songs, guided meditations, and heartfelt testimonies shared by community members.</p>
        <div class="event-video">
          <h3>Preview Video</h3>
          <iframe width="100%" height="200" src="https://www.youtube.com/embed/m2lT7GNN9Jc" title="God So Good: The Full Concert Experience | Life.Church Worship" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <ul class="event-highlights">
          <li>üé§ Featured Artists: Worship Band "Harmony Voices" & Guest Speaker Rev. Elena Torres</li>
          <li>üôè Activities: Prayer Circles, Live Acoustic Sets, and Fellowship Dinner</li>
          <li>üí´ Special Focus: Themes of Gratitude and Renewal</li>
        </ul>
        <button class="book-btn">Book</button>
      </div>
      <div class="event-card virtual-event" data-event="virtual-worship">
        <img src="worship.jpeg" alt="Virtual worship service on laptop screen" width="100px" height="100px" style="border-radius: 100%;">
        <h2>Virtual Worship Gathering 2026 <span class="virtual-badge">üåê Virtual</span></h2>
        <p><strong>Date:</strong> November 22, 2026<br>
        <strong>Time:</strong> 7:00 PM - 8:30 PM<br>
        <strong>Location:</strong> Online via Zoom<br>
        <strong>Capacity:</strong> Unlimited<br>
        <strong>Ticket Price:</strong> Free</p>
        <p>Connect from anywhere in the world for an inspiring virtual worship experience. Enjoy live-streamed music, interactive prayer sessions, and a message of hope and encouragement.</p>
        <div class="event-video">
          <h3>Sample Virtual Session</h3>
          <iframe width="100%" height="200" src="https://www.youtube.com/embed/lPbR-xccRkU" title="Let us Worship - Live from Sacramento - Full Concert Film" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <ul class="event-highlights">
          <li>üìπ Featured: Live stream hosted by "Harmony Voices" & Guest Speaker via Video</li>
          <li>üí¨ Interactive Features: Live Chat Prayers, Virtual Breakout Rooms for Discussion, and Post-Event Replay</li>
          <li>üåç Theme: "Faith Without Borders" ‚Äì Building Community in the Digital Age</li>
        </ul>
        <button class="book-btn">Book</button>
      </div>
      <div class="event-card" data-event="tech">
        <img src="https://images.unsplash.com/photo-1517433456452-f9633a875f6f?ixlib=rb-4.0.3&w=100&h=100&fit=crop&q=80" alt="Innovative tech conference attendees" width="100px" height="100px" style="border-radius: 100%;">
        <h2>Tech Expo 2025</h2>
        <p><strong>Date:</strong> December 5, 2026<br>
        <strong>Time:</strong> 10:00 AM - 5:00 PM<br>
        <strong>Location:</strong> Lab 1, Innovation Campus<br>
        <strong>Capacity:</strong> Unlimited (First-Come, First-Served)<br>
        <strong>Ticket Price:</strong> $15 (Early Bird) / $20 (Door)</p>
        <p>Explore the latest in technology, gadgets, and innovation. Discover cutting-edge demos, startup pitches, and hands-on workshops on AI, VR, and sustainable tech solutions.</p>
        <div class="event-video">
          <h3>Expo Highlights</h3>
          <iframe width="100%" height="200" src="https://www.youtube.com/embed/M-CBDQrAeOM" title="Defence & Tech Expo 2025 Chennai | India‚Äôs Innovation Hub" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <ul class="event-highlights">
          <li>üé§ Keynote Speakers: Dr. Alex Rivera (AI Pioneer) & Sarah Chen (VR Innovator)</li>
          <li>üì± Exhibits: 20+ Booths with Drones, Smart Devices, and Blockchain Demos</li>
          <li>ü§ù Networking: Panel Discussions, Speed Mentoring, and Tech Happy Hour</li>
        </ul>
        <button class="book-btn">Book</button>
      </div>
      <div class="event-card virtual-event" data-event="virtual-tech">
        <img src="https://images.unsplash.com/photo-1677442136019-21780ecad995?ixlib=rb-4.0.3&w=100&h=100&fit=crop&q=80" alt="Virtual AI workshop with digital screens" width="100px" height="100px" style="border-radius: 100%;">
        <h2>Virtual AI Workshop 2025 <span class="virtual-badge">üåê Virtual</span></h2>
        <p><strong>Date:</strong> November 20, 2026<br>
        <strong>Time:</strong> 2:00 PM - 4:00 PM<br>
        <strong>Location:</strong> Online via Zoom<br>
        <strong>Capacity:</strong> 100 participants<br>
        <strong>Ticket Price:</strong> Free (Registration Required)</p>
        <p>Dive into the world of artificial intelligence with interactive sessions led by industry experts. Perfect for beginners and enthusiasts alike.</p>
        <div class="event-video">
          <h3>Workshop Preview</h3>
          <iframe width="100%" height="200" src="https://www.youtube.com/embed/Yq0QkCxoTHM" title="Google‚Äôs AI Course for Beginners (in 10 minutes)!" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <ul class="event-highlights">
          <li>üë©‚Äçüíª Instructor: Dr. Mia Lopez, AI Specialist at TechNova</li>
          <li>üß† Topics: Machine Learning Basics, Ethical AI Considerations, and Simple Model Building</li>
          <li>üîß Interactive Elements: Live Coding Sessions, Breakout Rooms for Group Projects, and Real-Time Q&A</li>
        </ul>
         <button class="book-btn">Book</button>
      </div>
      <div class="event-card virtual-event" data-event="virtual-culture">
        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&w=100&h=100&fit=crop&q=80" alt="Virtual storytelling session with global participants" width="100px" height="100px" style="border-radius: 100%;">
        <h2>Virtual Global Stories Night <span class="virtual-badge">üåê Virtual</span></h2>
        <p><strong>Date:</strong> December 10, 2026<br>
        <strong>Time:</strong> 8:00 PM - 9:30 PM<br>
        <strong>Location:</strong> Online via YouTube Live<br>
        <strong>Capacity:</strong> Unlimited<br>
        <strong>Ticket Price:</strong> Donation-based (Suggested $10)</p>
        <p>Immerse yourself in captivating tales from storytellers around the world, fostering connection and cultural exchange from the comfort of your home.</p>
        <div class="event-video">
          <h3>Storytelling Preview</h3>
          <iframe width="100%" height="200" src="https://www.youtube.com/embed/hNuAv-42jzY" title="Give me 9min, and I'll improve your storytelling skills by 176%" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>
        <ul class="event-highlights">
          <li>üìñ Featured Storytellers: Voices from 5 Continents, Including Indigenous Narrators and Diaspora Authors</li>
          <li>üí¨ Interactive Features: Live Chat Polls, Audience Shoutouts, and Post-Event Discussion Forum</li>
          <li>üåç Theme: Unity in Diversity ‚Äì Stories of Resilience and Shared Humanity</li>
        </ul>
        <button class="book-btn">Book</button>
      </div>
    </section>
    <div class="rsvp-modal-overlay" id="rsvp-modal">
      <section class="rsvp-section" id="rsvp-section" style="display:none;">
        <button class="rsvp-modal-close" id="rsvp-close" title="Close">&times;</button>
        <h2 id="rsvp-event-name"></h2>
        <form id="rsvp-form" autocomplete="off">
          <label for="name">Your Name:</label>
          <input type="text" id="name" name="name" required>
          <label for="attending">Will you attend?</label>
          <select id="attending" name="attending" required>
            <option value="">Select</option>
            <option value="yes">Yes, I'll be there!</option>
            <option value="no">Sorry, can't make it</option>
          </select>
          <button class="book-btn">Book</button>
        </form>
        <div id="rsvp-message" class="rsvp-message" style="display:none;"></div>
      </section>
    </div>
    <!-- Login Modal -->
    <div class="login-modal-overlay" id="login-modal">
      <section class="login-section" id="login-section">
        <button class="login-modal-close" id="login-close" title="Close">&times;</button>
        <h2>Login to Your Account</h2>
        <!-- Google Sign-In -->
        <div id="g_id_onload"
             data-client_id="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com"
             data-callback="handleGoogleLogin"
             data-auto_prompt="false">
        </div>
        <div class="g_id_signin" data-type="standard"></div>
        <!-- GitHub Sign-In Button -->
        <a href="#" id="github-signin-btn" class="github-signin">
          <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub">
          Sign in with GitHub
        </a>
        <!-- Microsoft Sign-In Button -->
        <a href="#" id="microsoft-signin-btn" class="microsoft-signin">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/44/Microsoft_logo.svg/18px-Microsoft_logo.svg.png" alt="Microsoft">
          Sign in with Microsoft
        </a>
        <div class="divider">
          <span>or</span>
        </div>
        <form id="login-form" autocomplete="off">
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" required>
          <label for="password">Password:</label>
          <input type="password" id="password" name="password" required>
          <button type="submit">Login</button>
        </form>
        <div id="login-message" class="login-message"></div>
        <div class="login-link">
          <a href="#" id="register-link">Don't have an account? Register here</a>
        </div>
      </section>
    </div>
    <section class="about-section" id="about" style="display:none;">
      <h2>About</h2>
      <p>Welcome to our event platform! Book and RSVP for the best events in town. We bring together culture, worship, and technology in one place for your convenience and joy. Now featuring virtual events for global accessibility!</p>
      <ul style="text-align:left;max-width:400px;margin:1em auto 0 auto;">
        <li>Easy event booking</li>
        <li>Instant RSVP confirmation</li>
        <li>Modern, responsive design</li>
        <li>Secure and private</li>
        <li>Hybrid & Virtual Options</li>
      </ul>
    </section>
    <section class="contact-section" id="contact" style="display:none;">
      <h2>Contact</h2>
      <p>Email: <a href="mailto:indekeja@yahoo.com">indekeja@yahoo.com</a><br>Phone: +255748815338</p>
      <form id="contact-form" style="margin-top:1em;display:flex;flex-direction:column;gap:0.7em;max-width:600px;margin-left:auto;margin-right:auto;">
        <label for="contact-name">Your Name:</label>
        <input type="text" id="contact-name" name="contact-name" required>
        <label for="contact-message">Message:</label>
        <textarea id="contact-message" name="contact-message" rows="3" required></textarea>
        <button type="submit">Send Message</button>
        <div id="contact-success" style="display:none;color:#4caf50;font-weight:bold;margin-top:0.5em;">Thank you for contacting us!</div>
      </form>
    </section>
  </main>
  <!-- Google Identity Services Script -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <script>
    // GitHub OAuth Configuration
    const GITHUB_CLIENT_ID = 'YOUR_GITHUB_CLIENT_ID'; // Replace with your GitHub OAuth App Client ID
    const GITHUB_REDIRECT_URI = window.location.origin + window.location.pathname; // Current page URL

    // Microsoft OAuth Configuration
    const MICROSOFT_CLIENT_ID = 'YOUR_MICROSOFT_CLIENT_ID'; // Replace with your Microsoft Azure AD App Client ID
    const MICROSOFT_TENANT = 'common'; // Use 'common' for multi-tenant, or specific tenant ID
    const MICROSOFT_REDIRECT_URI = window.location.origin + window.location.pathname; // Current page URL

    // Demo credentials for email/password
    const DEMO_EMAIL = 'email@test.com';
    const DEMO_PASSWORD = 'password123';

    // PKCE Helper Functions
    function generateCodeVerifier() {
      const array = new Uint8Array(32);
      crypto.getRandomValues(array);
      return btoa(String.fromCharCode(...array)).replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
    }

    async function generateCodeChallenge(verifier) {
      const encoder = new TextEncoder();
      const data = encoder.encode(verifier);
      const digest = await crypto.subtle.digest('SHA-256', data);
      return btoa(String.fromCharCode(...new Uint8Array(digest)))
        .replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
    }

    function showLoginError(message) {
      const loginMessage = document.getElementById('login-message');
      loginMessage.textContent = message;
      loginMessage.className = 'login-message error';
      loginMessage.style.display = 'block';
    }

    function showLoginSuccess(username, displayName, provider) {
      const loginMessage = document.getElementById('login-message');
      loginMessage.textContent = `Welcome back, ${displayName}! ${provider} login successful.`;
      loginMessage.className = 'login-message success';
      loginMessage.style.display = 'block';
      
      // Simulate delay and close
      setTimeout(() => {
        closeLoginModal();
        // Update navbar to show "Logout" or user name
        const loginLink = document.querySelector('.nav-login');
        loginLink.textContent = `Welcome, ${displayName}`;
        loginLink.href = '#logout';
        loginLink.classList.remove('nav-login');
        loginLink.classList.add('nav-logout');
        // Optional: Store user info in localStorage
        localStorage.setItem('user', JSON.stringify({name: displayName, username: username, provider: provider}));
      }, 2000);
    }

    async function handleGitHubCallback() {
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      const error = urlParams.get('error');
      if (error) {
        console.error('GitHub OAuth Error:', error);
        showLoginError(`GitHub login failed: ${error}`);
        return;
      }
      if (!code) return;

      const verifier = sessionStorage.getItem('github_code_verifier');
      if (!verifier) {
        console.error('No code verifier found');
        showLoginError('GitHub login failed: No code verifier found');
        return;
      }

      try {
        const tokenResponse = await fetch('https://github.com/login/oauth/access_token', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Accept': 'application/json',
          },
          body: new URLSearchParams({
            client_id: GITHUB_CLIENT_ID,
            code: code,
            code_verifier: verifier,
            redirect_uri: GITHUB_REDIRECT_URI,
          }),
        });

        const tokenData = await tokenResponse.json();
        if (tokenData.error) {
          throw new Error(tokenData.error_description || 'Token exchange failed');
        }

        const accessToken = tokenData.access_token;
        // Fetch user info
        const userResponse = await fetch('https://api.github.com/user', {
          headers: {
            'Authorization': `Bearer ${accessToken}`,
          },
        });
        if (!userResponse.ok) {
          throw new Error('Failed to fetch user info');
        }
        const user = await userResponse.json();

        // Handle successful login
        showLoginSuccess(user.login, user.name || user.login, 'GitHub');

        // Clean up URL
        window.history.replaceState({}, document.title, window.location.pathname);
        sessionStorage.removeItem('github_code_verifier');
      } catch (err) {
        console.error('GitHub Login Error:', err);
        showLoginError('GitHub login failed: ' + err.message);
      }
    }

    async function handleMicrosoftCallback() {
      const urlParams = new URLSearchParams(window.location.search);
      const code = urlParams.get('code');
      const error = urlParams.get('error');
      if (error) {
        console.error('Microsoft OAuth Error:', error);
        showLoginError(`Microsoft login failed: ${error}`);
        return;
      }
      if (!code) return;

      const verifier = sessionStorage.getItem('microsoft_code_verifier');
      if (!verifier) {
        console.error('No code verifier found');
        showLoginError('Microsoft login failed: No code verifier found');
        return;
      }

      try {
        const tokenResponse = await fetch(`https://login.microsoftonline.com/${MICROSOFT_TENANT}/oauth2/v2.0/token`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
          body: new URLSearchParams({
            client_id: MICROSOFT_CLIENT_ID,
            code: code,
            code_verifier: verifier,
            redirect_uri: MICROSOFT_REDIRECT_URI,
            grant_type: 'authorization_code',
            scope: 'openid profile email User.Read',
          }),
        });

        const tokenData = await tokenResponse.json();
        if (tokenData.error) {
          throw new Error(tokenData.error_description || 'Token exchange failed');
        }

        const accessToken = tokenData.access_token;
        // Fetch user info
        const userResponse = await fetch('https://graph.microsoft.com/v1.0/me', {
          headers: {
            'Authorization': `Bearer ${accessToken}`,
          },
        });
        if (!userResponse.ok) {
          throw new Error('Failed to fetch user info');
        }
        const user = await userResponse.json();

        // Handle successful login
        showLoginSuccess(user.userPrincipalName || user.mail, user.displayName || user.userPrincipalName, 'Microsoft');

        // Clean up URL
        window.history.replaceState({}, document.title, window.location.pathname);
        sessionStorage.removeItem('microsoft_code_verifier');
      } catch (err) {
        console.error('Microsoft Login Error:', err);
        showLoginError('Microsoft login failed: ' + err.message);
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Check for OAuth callbacks on load
      handleGitHubCallback();
      handleMicrosoftCallback();

      // Navigation handling
      const navLinks = document.querySelectorAll('.nav-link');
      const sections = {
        home: document.getElementById('events'),
        about: document.getElementById('about'),
        contact: document.getElementById('contact')
      };

      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Check if it's the login link
          if (this.classList.contains('nav-login')) {
            openLoginModal();
            return;
          }
          
          // Remove active class from all links
          navLinks.forEach(l => l.classList.remove('active'));
          
          // Add active to clicked link
          this.classList.add('active');
          
          // Hide all sections
          Object.values(sections).forEach(section => {
            section.style.display = 'none';
          });
          
          // Show the corresponding section
          const targetId = this.getAttribute('href').substring(1); // Remove #
          const targetSection = sections[targetId] || sections.home;
          targetSection.style.display = 'block';
          
          // Add active class for animations if needed
          if (targetSection !== sections.home) {
            targetSection.classList.add('active');
          } else {
            sections.home.classList.remove('active');
          }
        });
      });

      // Login Modal Handling
      const loginModal = document.getElementById('login-modal');
      const loginSection = document.getElementById('login-section');
      const loginClose = document.getElementById('login-close');
      const loginForm = document.getElementById('login-form');
      const loginMessage = document.getElementById('login-message');
      const registerLink = document.getElementById('register-link');
      const githubSigninBtn = document.getElementById('github-signin-btn');
      const microsoftSigninBtn = document.getElementById('microsoft-signin-btn');

      function openLoginModal() {
        loginModal.classList.add('active');
        loginSection.style.display = 'block';
      }

      function closeLoginModal() {
        loginModal.classList.remove('active');
        loginSection.style.display = 'none';
        loginForm.reset();
        loginMessage.style.display = 'none';
      }

      loginClose.addEventListener('click', closeLoginModal);
      loginModal.addEventListener('click', function(e) {
        if (e.target === this) {
          closeLoginModal();
        }
      });

      // GitHub Login Button Handler
      githubSigninBtn.addEventListener('click', async function(e) {
        e.preventDefault();
        const verifier = generateCodeVerifier();
        const challenge = await generateCodeChallenge(verifier);
        sessionStorage.setItem('github_code_verifier', verifier);

        const state = generateCodeVerifier().substring(0, 16); // Simple state for CSRF
        sessionStorage.setItem('github_state', state);

        const params = new URLSearchParams({
          client_id: GITHUB_CLIENT_ID,
          redirect_uri: GITHUB_REDIRECT_URI,
          scope: 'user',
          state: state,
          code_challenge: challenge,
          code_challenge_method: 'S256',
        });

        window.location.href = `https://github.com/login/oauth/authorize?${params.toString()}`;
      });

      // Microsoft Login Button Handler
      microsoftSigninBtn.addEventListener('click', async function(e) {
        e.preventDefault();
        const verifier = generateCodeVerifier();
        const challenge = await generateCodeChallenge(verifier);
        sessionStorage.setItem('microsoft_code_verifier', verifier);

        const state = generateCodeVerifier().substring(0, 16); // Simple state for CSRF
        sessionStorage.setItem('microsoft_state', state);

        const params = new URLSearchParams({
          client_id: MICROSOFT_CLIENT_ID,
          response_type: 'code',
          redirect_uri: MICROSOFT_REDIRECT_URI,
          scope: 'openid profile email User.Read',
          state: state,
          code_challenge: challenge,
          code_challenge_method: 'S256',
          response_mode: 'query',
        });

        window.location.href = `https://login.microsoftonline.com/${MICROSOFT_TENANT}/oauth2/v2.0/authorize?${params.toString()}`;
      });

      // Google Login Handler
      window.handleGoogleLogin = function(response) {
        try {
          // In a real app, decode the JWT token (e.g., using a library) and send to backend for verification
          // For demo: Simulate success with user email from token
          console.log('Google Login Response:', response);
          const payload = JSON.parse(atob(response.credential.split('.')[1]));
          const userEmail = payload.email;
          const userName = payload.name;

          showLoginSuccess(userEmail, userName, 'Google');
        } catch (err) {
          console.error('Google Login Error:', err);
          showLoginError('Google login failed: Invalid token');
        }
      };

      // Email/Password login with error handling
      loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const email = formData.get('email');
        const password = formData.get('password');
        
        if (!email || !password) {
          showLoginError('Please fill in all fields.');
          return;
        }

        // Demo validation: Check against demo credentials
        if (email === DEMO_EMAIL && password === DEMO_PASSWORD) {
          showLoginSuccess(email, email, 'Email');
        } else {
          showLoginError('Invalid email or password. Demo: email@test.com / password123');
        }
      });

      // Register link (placeholder - could open another modal)
      registerLink.addEventListener('click', function(e) {
        e.preventDefault();
        alert('Registration feature coming soon! For now, use demo credentials: email@test.com / password123');
      });

      // Event cards book buttons
      const bookButtons = document.querySelectorAll('.book-btn:not([disabled])');
      const rsvpModal = document.getElementById('rsvp-modal');
      const rsvpSection = document.getElementById('rsvp-section');
      const rsvpEventName = document.getElementById('rsvp-event-name');
      const rsvpClose = document.getElementById('rsvp-close');
      const rsvpForm = document.getElementById('rsvp-form');
      const rsvpMessage = document.getElementById('rsvp-message');

      bookButtons.forEach(button => {
        button.addEventListener('click', function() {
          const eventCard = this.closest('.event-card');
          const eventName = eventCard.querySelector('h2').textContent;
          const eventDataAttr = eventCard.dataset.event;
          rsvpEventName.textContent = eventName;
          
          // Store event type in a hidden input for email template
          let hiddenEventType = rsvpForm.querySelector('[name="event_type"]');
          if (!hiddenEventType) {
            hiddenEventType = document.createElement('input');
            hiddenEventType.type = 'hidden';
            hiddenEventType.name = 'event_type';
            rsvpForm.appendChild(hiddenEventType);
          }
          hiddenEventType.value = eventDataAttr;
          
          rsvpModal.classList.add('active');
          rsvpSection.style.display = 'block';
        });
      });

      // Close modal
      rsvpClose.addEventListener('click', closeRsvpModal);
      rsvpModal.addEventListener('click', function(e) {
        if (e.target === this) {
          closeRsvpModal();
        }
      });

      function closeRsvpModal() {
        rsvpModal.classList.remove('active');
        rsvpSection.style.display = 'none';
        rsvpForm.reset();
        const hiddenEventType = rsvpForm.querySelector('[name="event_type"]');
        if (hiddenEventType) {
          rsvpForm.removeChild(hiddenEventType);
        }
        rsvpMessage.style.display = 'none';
      }

      // RSVP form submission (simulated)
      rsvpForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const name = formData.get('name');
        const attending = formData.get('attending');
        const eventType = formData.get('event_type');
        const eventName = rsvpEventName.textContent;
        
        if (name && attending && eventType) {
          rsvpMessage.textContent = attending === 'yes' 
            ? `Great! RSVP confirmed for ${eventName}, ${name}! We've notified the organizers.` 
            : `Thanks for letting us know, ${name}. Hope to see you next time!`;
          rsvpMessage.className = 'rsvp-message success';
          rsvpMessage.style.display = 'block';
          
          // Simulate delay
          setTimeout(() => {
            closeRsvpModal();
          }, 2000);
        } else {
          rsvpMessage.textContent = 'Please fill in all fields.';
          rsvpMessage.className = 'rsvp-message error';
          rsvpMessage.style.display = 'block';
        }
      });

      // Contact form
      const contactForm = document.getElementById('contact-form');
      const contactSuccess = document.getElementById('contact-success');

      contactForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const name = formData.get('contact-name');
        const message = formData.get('contact-message');
        
        if (name && message) {
          contactSuccess.textContent = 'Thank you for contacting us! Message sent successfully.';
          contactSuccess.style.display = 'block';
          this.reset();
          // Simulate delay
          setTimeout(() => {
            contactSuccess.style.display = 'none';
            contactSuccess.textContent = 'Thank you for contacting us!';
          }, 3000);
        }
      });

      // Initial setup: Show home section
      sections.home.style.display = 'block';
    });
  </script>
</body>
</html>
```
